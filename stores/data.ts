import { defineStore } from 'pinia';

export const useLeagueStore = defineStore('league', {
  state: () => ({
    leagueData: null as any | null,
    fixturesData: null as any | null,
    nextGamesData: null as any | null,
    lastGamesData: null as any | null,
    nextRoundData: null as any | null,
  }),
  actions: {
    async fetchLeagueData(leagueId: number, season: number) {
      const url = `https://api-football-v1.p.rapidapi.com/v3/standings?league=${leagueId}&season=${season}`;
      const headers = {
        'x-rapidapi-key': '9e5e2785cbmshd7e0f7a68c44835p1fd16fjsndac8dbc9c39d',
        'x-rapidapi-host': 'api-football-v1.p.rapidapi.com',
      };

      try {
        const response = await fetch(url, {
          method: 'GET',
          headers: headers,
        });
        const data = await response.json();
        if (data && data.response && data.response.length > 0) {
          this.leagueData = data.response[0].league;
          this.nextRoundData = this.leagueData.standings[0][0].all.played
        } else {
          this.leagueData = null;
        }
      } catch (error) {
        console.error('Error fetching league data:', error);
        this.leagueData = null;
      }
    },

    async fetchNextFixturesData(leagueId: number, season: number) {
      const url = `https://api-football-v1.p.rapidapi.com/v3/fixtures?league=${leagueId}&season=${season}&next=20`;
      const headers = {
        'x-rapidapi-key': '9e5e2785cbmshd7e0f7a68c44835p1fd16fjsndac8dbc9c39d',
        'x-rapidapi-host': 'api-football-v1.p.rapidapi.com',
      };

      try {
        const response = await fetch(url, {
          method: 'GET',
          headers: headers,
        });
        const data = await response.json();
        if (data && data.response) {
          this.nextGamesData = data.response;
        } else {
          this.nextGamesData = null;
        }
      } catch (error) {
        console.error('Error fetching fixtures data:', error);
        this.nextGamesData = null;
      }
    },

    async fetchLastFixturesData(leagueId: number, season: number) {
      const url = `https://api-football-v1.p.rapidapi.com/v3/fixtures?league=${leagueId}&season=${season}&last=20`;
      const headers = {
        'x-rapidapi-key': '9e5e2785cbmshd7e0f7a68c44835p1fd16fjsndac8dbc9c39d',
        'x-rapidapi-host': 'api-football-v1.p.rapidapi.com',
      };

      try {
        // const response = await fetch(url, {
        //   method: 'GET',
        //   headers: headers,
        // });
        // const data = await response.json();
        // if (data && data.response) {
        //   this.lastGamesData = data.response;
        // } else {
        //   this.lastGamesData = null;
        // }
        this.lastGamesData = json
      } catch (error) {
        console.error('Error fetching fixtures data:', error);
        this.lastGamesData = null;
      }
    },

    async fetchNextRound(leagueId: number, season: number, round: number) {
      const url = `https://api-football-v1.p.rapidapi.com/v3/fixtures?league=${leagueId}&season=${season}&round=Regular%20Season%20-%20${round}`;
      const headers = {
        'x-rapidapi-key': '9e5e2785cbmshd7e0f7a68c44835p1fd16fjsndac8dbc9c39d',
        'x-rapidapi-host': 'api-football-v1.p.rapidapi.com',
      };

      try {
        const response = await fetch(url, {
          method: 'GET',
          headers: headers,
        });
        const data = await response.json();
        if (data && data.response) {
          this.nextRoundData = data.response;
          console.log(this.nextRoundData)
        } else {
          this.nextRoundData = null;
        }
      } catch (error) {
        console.error('Error fetching fixtures data:', error);
        this.nextRoundData = null;
      }
    }
  },
});


const json = [ { "fixture": { "id": 1223986, "referee": "C. Dingert", "timezone": "UTC", "date": "2024-09-01T15:30:00+00:00", "timestamp": 1725204600, "periods": { "first": 1725204600, "second": 1725208200 }, "venue": { "id": 700, "name": "Allianz Arena", "city": "München" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 2" }, "teams": { "home": { "id": 157, "name": "Bayern München", "logo": "https://media.api-sports.io/football/teams/157.png", "winner": true }, "away": { "id": 160, "name": "SC Freiburg", "logo": "https://media.api-sports.io/football/teams/160.png", "winner": false } }, "goals": { "home": 2, "away": 0 }, "score": { "halftime": { "home": 1, "away": 0 }, "fulltime": { "home": 2, "away": 0 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223988, "referee": "M. Petersen", "timezone": "UTC", "date": "2024-09-01T13:30:00+00:00", "timestamp": 1725197400, "periods": { "first": 1725197400, "second": 1725201000 }, "venue": { "id": 723, "name": "Voith-Arena", "city": "Heidenheim an der Brenz" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 2" }, "teams": { "home": { "id": 180, "name": "1. FC Heidenheim", "logo": "https://media.api-sports.io/football/teams/180.png", "winner": true }, "away": { "id": 170, "name": "FC Augsburg", "logo": "https://media.api-sports.io/football/teams/170.png", "winner": false } }, "goals": { "home": 4, "away": 0 }, "score": { "halftime": { "home": 2, "away": 0 }, "fulltime": { "home": 4, "away": 0 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223984, "referee": "M. Jöllenbeck", "timezone": "UTC", "date": "2024-08-31T16:30:00+00:00", "timestamp": 1725121800, "periods": { "first": 1725121800, "second": 1725125400 }, "venue": { "id": 699, "name": "BayArena", "city": "Leverkusen" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 2" }, "teams": { "home": { "id": 168, "name": "Bayer Leverkusen", "logo": "https://media.api-sports.io/football/teams/168.png", "winner": false }, "away": { "id": 173, "name": "RB Leipzig", "logo": "https://media.api-sports.io/football/teams/173.png", "winner": true } }, "goals": { "home": 2, "away": 3 }, "score": { "halftime": { "home": 2, "away": 1 }, "fulltime": { "home": 2, "away": 3 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223992, "referee": "F. Exner", "timezone": "UTC", "date": "2024-08-31T13:30:00+00:00", "timestamp": 1725111000, "periods": { "first": 1725111000, "second": 1725114600 }, "venue": { "id": 725, "name": "Holstein-Stadion", "city": "Kiel" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 2" }, "teams": { "home": { "id": 191, "name": "Holstein Kiel", "logo": "https://media.api-sports.io/football/teams/191.png", "winner": false }, "away": { "id": 161, "name": "VfL Wolfsburg", "logo": "https://media.api-sports.io/football/teams/161.png", "winner": true } }, "goals": { "home": 0, "away": 2 }, "score": { "halftime": { "home": 0, "away": 2 }, "fulltime": { "home": 0, "away": 2 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223991, "referee": "S. Storks", "timezone": "UTC", "date": "2024-08-31T13:30:00+00:00", "timestamp": 1725111000, "periods": { "first": 1725111000, "second": 1725114600 }, "venue": { "id": 751, "name": "Vonovia Ruhrstadion", "city": "Bochum" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 2" }, "teams": { "home": { "id": 176, "name": "VfL Bochum", "logo": "https://media.api-sports.io/football/teams/176.png", "winner": false }, "away": { "id": 163, "name": "Borussia Mönchengladbach", "logo": "https://media.api-sports.io/football/teams/163.png", "winner": true } }, "goals": { "home": 0, "away": 2 }, "score": { "halftime": { "home": 0, "away": 0 }, "fulltime": { "home": 0, "away": 2 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223989, "referee": "R. Hartmann", "timezone": "UTC", "date": "2024-08-31T13:30:00+00:00", "timestamp": 1725111000, "periods": { "first": 1725111000, "second": 1725114600 }, "venue": { "id": null, "name": "Weserstadion", "city": "Bremen" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 2" }, "teams": { "home": { "id": 162, "name": "Werder Bremen", "logo": "https://media.api-sports.io/football/teams/162.png", "winner": null }, "away": { "id": 165, "name": "Borussia Dortmund", "logo": "https://media.api-sports.io/football/teams/165.png", "winner": null } }, "goals": { "home": 0, "away": 0 }, "score": { "halftime": { "home": 0, "away": 0 }, "fulltime": { "home": 0, "away": 0 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223987, "referee": "F. Badstübner", "timezone": "UTC", "date": "2024-08-31T13:30:00+00:00", "timestamp": 1725111000, "periods": { "first": 1725111000, "second": 1725114600 }, "venue": { "id": 10491, "name": "Deutsche Bank Park", "city": "Frankfurt am Main" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 2" }, "teams": { "home": { "id": 169, "name": "Eintracht Frankfurt", "logo": "https://media.api-sports.io/football/teams/169.png", "winner": true }, "away": { "id": 167, "name": "1899 Hoffenheim", "logo": "https://media.api-sports.io/football/teams/167.png", "winner": false } }, "goals": { "home": 3, "away": 1 }, "score": { "halftime": { "home": 2, "away": 0 }, "fulltime": { "home": 3, "away": 1 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223985, "referee": "T. Gerach", "timezone": "UTC", "date": "2024-08-31T13:30:00+00:00", "timestamp": 1725111000, "periods": { "first": 1725111000, "second": 1725114600 }, "venue": { "id": 20473, "name": "MHPArena", "city": "Stuttgart" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 2" }, "teams": { "home": { "id": 172, "name": "VfB Stuttgart", "logo": "https://media.api-sports.io/football/teams/172.png", "winner": null }, "away": { "id": 164, "name": "FSV Mainz 05", "logo": "https://media.api-sports.io/football/teams/164.png", "winner": null } }, "goals": { "home": 3, "away": 3 }, "score": { "halftime": { "home": 2, "away": 1 }, "fulltime": { "home": 3, "away": 3 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223990, "referee": "B. Dankert", "timezone": "UTC", "date": "2024-08-30T18:30:00+00:00", "timestamp": 1725042600, "periods": { "first": 1725042600, "second": 1725046200 }, "venue": { "id": 748, "name": "Stadion An der Alten Försterei", "city": "Berlin" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 2" }, "teams": { "home": { "id": 182, "name": "Union Berlin", "logo": "https://media.api-sports.io/football/teams/182.png", "winner": true }, "away": { "id": 186, "name": "FC St. Pauli", "logo": "https://media.api-sports.io/football/teams/186.png", "winner": false } }, "goals": { "home": 1, "away": 0 }, "score": { "halftime": { "home": 1, "away": 0 }, "fulltime": { "home": 1, "away": 0 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223983, "referee": "S. Jablonski", "timezone": "UTC", "date": "2024-08-25T15:30:00+00:00", "timestamp": 1724599800, "periods": { "first": 1724599800, "second": 1724603400 }, "venue": { "id": 745, "name": "Millerntor-Stadion", "city": "Hamburg" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 1" }, "teams": { "home": { "id": 186, "name": "FC St. Pauli", "logo": "https://media.api-sports.io/football/teams/186.png", "winner": false }, "away": { "id": 180, "name": "1. FC Heidenheim", "logo": "https://media.api-sports.io/football/teams/180.png", "winner": true } }, "goals": { "home": 0, "away": 2 }, "score": { "halftime": { "home": 0, "away": 0 }, "fulltime": { "home": 0, "away": 2 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223981, "referee": "D. Siebert", "timezone": "UTC", "date": "2024-08-25T13:30:00+00:00", "timestamp": 1724592600, "periods": { "first": 1724592600, "second": 1724596200 }, "venue": { "id": 752, "name": "Volkswagen Arena", "city": "Wolfsburg" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 1" }, "teams": { "home": { "id": 161, "name": "VfL Wolfsburg", "logo": "https://media.api-sports.io/football/teams/161.png", "winner": false }, "away": { "id": 157, "name": "Bayern München", "logo": "https://media.api-sports.io/football/teams/157.png", "winner": true } }, "goals": { "home": 2, "away": 3 }, "score": { "halftime": { "home": 0, "away": 1 }, "fulltime": { "home": 2, "away": 3 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223977, "referee": "F. Zwayer", "timezone": "UTC", "date": "2024-08-24T16:30:00+00:00", "timestamp": 1724517000, "periods": { "first": 1724517000, "second": 1724520600 }, "venue": { "id": 19381, "name": "SIGNAL IDUNA PARK", "city": "Dortmund" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 1" }, "teams": { "home": { "id": 165, "name": "Borussia Dortmund", "logo": "https://media.api-sports.io/football/teams/165.png", "winner": true }, "away": { "id": 169, "name": "Eintracht Frankfurt", "logo": "https://media.api-sports.io/football/teams/169.png", "winner": false } }, "goals": { "home": 2, "away": 0 }, "score": { "halftime": { "home": 0, "away": 0 }, "fulltime": { "home": 2, "away": 0 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223982, "referee": "H. Osmers", "timezone": "UTC", "date": "2024-08-24T13:30:00+00:00", "timestamp": 1724506200, "periods": { "first": 1724506200, "second": 1724509800 }, "venue": { "id": 11899, "name": "MEWA ARENA", "city": "Mainz" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 1" }, "teams": { "home": { "id": 164, "name": "FSV Mainz 05", "logo": "https://media.api-sports.io/football/teams/164.png", "winner": null }, "away": { "id": 182, "name": "Union Berlin", "logo": "https://media.api-sports.io/football/teams/182.png", "winner": null } }, "goals": { "home": 1, "away": 1 }, "score": { "halftime": { "home": 0, "away": 0 }, "fulltime": { "home": 1, "away": 1 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223980, "referee": "S. Stegemann", "timezone": "UTC", "date": "2024-08-24T13:30:00+00:00", "timestamp": 1724506200, "periods": { "first": 1724506200, "second": 1724509800 }, "venue": { "id": 698, "name": "WWK Arena", "city": "Augsburg" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 1" }, "teams": { "home": { "id": 170, "name": "FC Augsburg", "logo": "https://media.api-sports.io/football/teams/170.png", "winner": null }, "away": { "id": 162, "name": "Werder Bremen", "logo": "https://media.api-sports.io/football/teams/162.png", "winner": null } }, "goals": { "home": 2, "away": 2 }, "score": { "halftime": { "home": 2, "away": 1 }, "fulltime": { "home": 2, "away": 2 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223979, "referee": "T. Welz", "timezone": "UTC", "date": "2024-08-24T13:30:00+00:00", "timestamp": 1724506200, "periods": { "first": 1724506200, "second": 1724509800 }, "venue": { "id": 12717, "name": "Europa-Park Stadion", "city": "Freiburg im Breisgau" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 1" }, "teams": { "home": { "id": 160, "name": "SC Freiburg", "logo": "https://media.api-sports.io/football/teams/160.png", "winner": true }, "away": { "id": 172, "name": "VfB Stuttgart", "logo": "https://media.api-sports.io/football/teams/172.png", "winner": false } }, "goals": { "home": 3, "away": 1 }, "score": { "halftime": { "home": 1, "away": 1 }, "fulltime": { "home": 3, "away": 1 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223978, "referee": "T. Stieler", "timezone": "UTC", "date": "2024-08-24T13:30:00+00:00", "timestamp": 1724506200, "periods": { "first": 1724506200, "second": 1724509800 }, "venue": { "id": 724, "name": "PreZero Arena", "city": "Sinsheim" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 1" }, "teams": { "home": { "id": 167, "name": "1899 Hoffenheim", "logo": "https://media.api-sports.io/football/teams/167.png", "winner": true }, "away": { "id": 191, "name": "Holstein Kiel", "logo": "https://media.api-sports.io/football/teams/191.png", "winner": false } }, "goals": { "home": 3, "away": 2 }, "score": { "halftime": { "home": 2, "away": 0 }, "fulltime": { "home": 3, "away": 2 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223976, "referee": "B. Brand", "timezone": "UTC", "date": "2024-08-24T13:30:00+00:00", "timestamp": 1724506200, "periods": { "first": 1724506200, "second": 1724509800 }, "venue": { "id": 738, "name": "Red Bull Arena", "city": "Leipzig" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 1" }, "teams": { "home": { "id": 173, "name": "RB Leipzig", "logo": "https://media.api-sports.io/football/teams/173.png", "winner": true }, "away": { "id": 176, "name": "VfL Bochum", "logo": "https://media.api-sports.io/football/teams/176.png", "winner": false } }, "goals": { "home": 1, "away": 0 }, "score": { "halftime": { "home": 0, "away": 0 }, "fulltime": { "home": 1, "away": 0 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } }, { "fixture": { "id": 1223975, "referee": "R. Schröder", "timezone": "UTC", "date": "2024-08-23T18:30:00+00:00", "timestamp": 1724437800, "periods": { "first": 1724437800, "second": 1724441400 }, "venue": { "id": 20471, "name": "BORUSSIA-PARK", "city": "Mönchengladbach" }, "status": { "long": "Match Finished", "short": "FT", "elapsed": 90 } }, "league": { "id": 78, "name": "Bundesliga", "country": "Germany", "logo": "https://media.api-sports.io/football/leagues/78.png", "flag": "https://media.api-sports.io/flags/de.svg", "season": 2024, "round": "Regular Season - 1" }, "teams": { "home": { "id": 163, "name": "Borussia Mönchengladbach", "logo": "https://media.api-sports.io/football/teams/163.png", "winner": false }, "away": { "id": 168, "name": "Bayer Leverkusen", "logo": "https://media.api-sports.io/football/teams/168.png", "winner": true } }, "goals": { "home": 2, "away": 3 }, "score": { "halftime": { "home": 0, "away": 2 }, "fulltime": { "home": 2, "away": 3 }, "extratime": { "home": null, "away": null }, "penalty": { "home": null, "away": null } } } ]